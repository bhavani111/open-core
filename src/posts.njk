---
layout: layouts/base.njk
title: All Posts
description: "Browse all blog posts from OpenCore Dispatch"
---

<h1>All Posts</h1>

{% if collections and collections.posts and collections.posts.length %}
  <p>Explore all <span id="post-count">{{ collections.posts.length }}</span> posts from the blog:</p>

  <!-- Search Box -->
  <div class="search-container">
    <input
      type="text"
      id="search-box"
      class="search-box"
      placeholder="🔍 Search posts by title, description, or tags..."
      aria-label="Search posts"
    />
  </div>

  <!-- Filter by Tags -->
  <div class="tags" id="tag-filter" style="margin-bottom: 2rem;">
    <button class="tag active" data-tag="all">All Posts</button>
    {% set allTags = [] %}
    {% for post in collections.posts %}
      {% if post.data.tags %}
        {% for tag in post.data.tags %}
          {% set allTags = (allTags.push(tag), allTags) %}
        {% endfor %}
      {% endif %}
    {% endfor %}
    {% set uniqueTags = allTags | unique %}
    {% for tag in uniqueTags %}
      <button class="tag" data-tag="{{ tag }}">#{{ tag }}</button>
    {% endfor %}
  </div>

  <ul class="post-list" id="post-list">
    {% for post in collections.posts | reverse %}
      <li class="post-item"
          data-title="{{ post.data.title | lower }}"
          data-description="{{ post.data.description | lower }}"
          data-tags="{% if post.data.tags %}{{ post.data.tags | join(',') | lower }}{% endif %}">
        <article>
          <h3><a href="{{ post.url }}">{{ post.data.title }}</a></h3>
          {% if post.data.description %}
            <p>{{ post.data.description }}</p>
          {% endif %}
          {% if post.data.tags %}
            <div class="tags">
              {% for tag in post.data.tags %}
                <span class="tag">#{{ tag }}</span>
              {% endfor %}
            </div>
          {% endif %}
          <time>{{ post.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) }}</time>
        </article>
      </li>
    {% endfor %}
  </ul>

  <p id="no-results" style="display: none; text-align: center; color: var(--text-muted); margin: 3rem 0;">
    No posts found matching your search. Try different keywords!
  </p>
{% else %}
  <p>No posts yet. Check back soon for new content!</p>
  <p><a href="/" class="btn">Back to Home</a></p>
{% endif %}

<script>
  const searchBox = document.getElementById('search-box');
  const postList = document.getElementById('post-list');
  const postItems = document.querySelectorAll('.post-item');
  const noResults = document.getElementById('no-results');
  const postCount = document.getElementById('post-count');
  const tagButtons = document.querySelectorAll('#tag-filter .tag');
  let currentTag = 'all';

  // Search functionality
  if (searchBox) {
    searchBox.addEventListener('input', (e) => {
      filterPosts();
    });
  }

  // Tag filter functionality
  tagButtons.forEach(button => {
    button.addEventListener('click', () => {
      tagButtons.forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');
      currentTag = button.dataset.tag;
      filterPosts();
    });
  });

  function filterPosts() {
    const searchTerm = searchBox ? searchBox.value.toLowerCase() : '';
    let visibleCount = 0;

    postItems.forEach(item => {
      const title = item.dataset.title || '';
      const description = item.dataset.description || '';
      const tags = item.dataset.tags || '';

      const matchesSearch = title.includes(searchTerm) ||
                           description.includes(searchTerm) ||
                           tags.includes(searchTerm);

      const matchesTag = currentTag === 'all' || tags.includes(currentTag.toLowerCase());

      if (matchesSearch && matchesTag) {
        item.style.display = '';
        visibleCount++;
      } else {
        item.style.display = 'none';
      }
    });

    if (postCount) {
      postCount.textContent = visibleCount;
    }

    if (noResults) {
      noResults.style.display = visibleCount === 0 ? 'block' : 'none';
    }

    if (postList) {
      postList.style.display = visibleCount === 0 ? 'none' : '';
    }
  }
</script>

<style>
  .tag.active {
    background: var(--primary-color);
    color: white;
  }

  .tag {
    cursor: pointer;
    user-select: none;
  }

  #tag-filter .tag {
    border: 2px solid var(--border-color);
  }

  #tag-filter .tag.active {
    border-color: var(--primary-color);
  }
</style>

